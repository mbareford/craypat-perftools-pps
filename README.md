# craypat-perftools-pps
A collection of scripts designed to post-process output produced by CrayPAT Perftools (v6.4.6 onwards).

The mosaic visualisation provided by CrayPAT Apprentice2 cannot show an entire communication heat map for high numbers of MPI ranks (e.g., > 1000). Hence, the reason for writing this series of app2mosaic python scripts, is to render a display (using python matplotlib) that gives the overall picture.

The app2mosaic_full_display script can take just two arguments the type of P2P communication data to display and the experiment data file.

app2mosaic_full_display -d 5 experiment.ap2-xml

The type of data is indicated by a simple numeric argument.

0 Byte Count
1 Call Count
2 Recv Time Total
3 Recv Time Max
4 Recv Time Min
5 Send Time Total
6 Send Time Max
7 Send Time Min

The experiment data file is generated by first running the pat_report utility with a previously generated ap2 file.

pat_report -f ap2-xml experiment.ap2

Examples of other types of app2mosaic_full_display commands follow.

The "-node" argument is used to show the node-to-node communication. Use of the "inter-node-only" qualifier excludes communication within nodes; i.e., the points where x=y are left blank.

app2mosaic_full_display -d 5 -node experiment.ap2-xml
app2mosaic_full_display -d 5 -node -inter-node-only experiment.ap2-xml

The "-node-summary" flag produces a bar plot that shows the percentage breakdown according to network distance in terms of
each communications metric. The left most bar (baseline) shows the percentage of communicating process pairs that are communicating within a node, communicating over a chassis and so on. This scheme is followed for the communication metric bars; e.g., the lowest segment of the right most bar shows the percentage of total message send time that can be attributed to processes communicating within a node.

app2mosaic_full_display -node-summary experiment.ap2-xml

Further details about the app2mosaic_full_display script can be viewed by running "app2mosaic_full_display -help".
